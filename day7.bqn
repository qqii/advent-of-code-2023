#!/usr/bin/env cbqn

# Part 1 Initial Idea:
# Build a table with headings:
# [ "Hand", "Bid", "Hand Score", "Card Score"]
# "Card Score" should be equivilent to comparing for the highest consecutive
# hand. Then sort with â‹ âˆ¨ â’.

e1 â† âŸ¨
  "32T3K 765"
  "T55J5 684"
  "KK677 28"
  "KTJJT 220"
  "QQQJA 483"
âŸ©

Split â† {((Â¯1+âŠ¢Ã—Â·+`Â»âŠ¸<)Â¬ğ•©=ğ•¨)âŠ”ğ•©}
Parse â† â‰âˆ˜>â€¢ParseFloatâŒ¾(1âŠ¸âŠ‘)âˆ˜(' 'âŠ¸Split)Â¨

hands â† âŒ½âŸ¨
  âŸ¨5âŸ©
  âŸ¨4, 1âŸ©
  âŸ¨3, 2âŸ©
  âŸ¨3, 1, 1âŸ©
  âŸ¨2, 2, 1âŸ©
  âŸ¨2, 1, 1, 1âŸ©
  âŸ¨1, 1, 1, 1, 1âŸ©
âŸ©
cards â† "23456789TJQKA"

# From BQNcrate: Count of occurrences of each unique major cell
CountOccurances â† /â¼âŠ
ScoreHand â† âŠ‘handsâŠ’â‹ˆ âˆ˜ âˆ¨âˆ˜CountOccurances
# 13 Cards -> Base 13
ScoreCards â† (13âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½) cardsâŠ¸âŠ
# Hands of 5 -> (ScoreHand ğ•©) Ã— 13Ã—5 
Score â† (ScoreHand((13â‹†5)âŠ¸Ã—âŠ¸+)ScoreCards)
Part1 â† {
  [c,b] â† Parse ğ•©
  # â‹ (Grade) gives the index if sorted, which is exactly what we need
  # Just add 1 and you're golden. 
  +Â´ b Ã— 1+â‹ ScoreÂ¨ c
}
â€¢Show âŸ¨"Example Part 1", Part1 e1âŸ© 

# Part 2 Initial Idea:
# Calculate the hand without jokers, then add 1 to the highest group before
# scoring.

cardsJ â† "J23456789TQKA"
ScoreHandJ â† {
  "JJJJJ"â‰¡ğ•© ? 6 ;
  js â† +Â´'J'= ğ•©
  not_js â† 'J'âŠ¸â‰ âŠ¸/ ğ•©
  j_h â† js+âŒ¾âŠ‘ âˆ¨âˆ˜CountOccurances not_js
  âŠ‘handsâŠ’â‹ˆ j_h
}
ScoreCardsJ â† (13âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½) cardsJâŠ¸âŠ
ScoreJ â† (ScoreHandJ((13â‹†5)âŠ¸Ã—âŠ¸+)ScoreCardsJ)
Part2 â† {
  [c,b] â† Parse ğ•©
  # â‹ (Grade) gives the index if sorted, which is exactly what we need
  # Just add 1 and you're golden. 
  +Â´ b Ã— 1+â‹ ScoreJÂ¨ c
}
â€¢Show âŸ¨"Example Part 2", Part2 e1âŸ© 

# Initial Thoughts:

# Trying out https://bqn.funmaker.moe/ today to replace BQNPAD. There's a bunch
# of nify features but the big one is their glyph hilighting.

# Skipping 5 to finish 3 yesterday, I've not had much time to keep reading but
# I've come across â‹ and â’ when searching BQNcrate. The stability example looks
# like a perfect way to solve today's problem.
# https://mlochbaum.github.io/BQN/doc/order.html#stability

# Post Part 1 Thoughts:

# When defining the card score I had the idea to map the cards into base 13,
# which works out pretty well. This made me realise that the hand score can also
# be included, so the order is completely predetermined in parallel.

# Piecing together the solution in Part1 could have been better, that's pretty
# brute forced. I went for âŒ¾ because I couldn't figure out how to vstack so
# that required me to practice defining Score as a train.

# All in all, I need to take a deeper look at â‹ and â’.

# Post Part 1 Thoughts:

# Not the cleanest thing in the world, a lot of copy and pasting to change a few
# things. ScoreHandJ is pretty ugly all things said, but it works! 

# https://bqn.funmaker.moe/'s glyph highlighting is really nice, and I've been
# able click less symbols. That said I'm not sure if I'm remembering the
# shortcut or just the glyph location, just as I did with BQNPAD. 

# Without tab autocomplete there's less memory for symbol names, which has it's
# good and bad side. I'm still going to stick with it though, in hopes of 
# being able to shell out symbols without thought.

# As an idea, maybe popping up the keymap as a keyboard will form a better
# association? 
# https://mlochbaum.github.io/BQN/keymap.html

# I acidentally pressed Ctrl s a dozen times, saving the file. This is a minor
# annoyance, but also the highest praise an editor can get - it's so good that
# I'm Ctrl s ing out of muscle memory. 

# The split window is really nice, and mirrors having a code window and
# terminal. Being able to keep the code window in a fixed location whilst also
# seeing the output was a great decision. The only mild annoyance is having to
# use the mouse to expand/contract the window - maybe a fold-up output? 

# The other thing to factor is the live preview. I do miss it a bit, but at the
# same time it forces me to think thorugh a problem before checking the output
# or getting distracted by errors.

# I couldn't figure out how to read input.txt so I eventually copied it back to
# my local editor. My go-to is â€¢FLines, so without it a lot of my code
# assumptions break.

# Rapid fire now:
# - Ctrl / doesn't add a space, and doesn't uncomment indented comments. Meh,
#   a style thing.
# - The data is not stored in the URL (so no accidentally corrupting the page
#   with too much data, but also no sharing links)

# That's about it, my vscode font is still broken is tab auto-complete and has
# spacing issues in the terminal, whilst beacon doesn't seem that easy to
# install. This is a good local maximum, and funmaker seems interested in
# continuing to improve it.

# Now to take a deeper read about â‹ and â’.

input â† â€¢FLines "inputs/day7.txt"
â€¢Show âŸ¨"Part 1", Part1 inputâŸ© 
â€¢Show âŸ¨"Part 2", Part2 inputâŸ© 